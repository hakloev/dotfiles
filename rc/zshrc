#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs..
alias ed25519key='ssh-keygen -t ed25519 -o -a 100'

alias mci='mvn clean install'
alias msb='mvn spring-boot:run'
alias mrpr='mvn release:prepare'
alias mrpe='mvn release:perform'

alias st="open -a Sublime\ Text.app $1"
alias weather='curl http://wttr.in/oslo'
alias cleanxcode="rm -rf $HOME/Library/Developer/Xcode/DerivedData/*"
alias clearnext="rm -rf $PWD/.next/cache"
alias cleantooth="sudo pkill bluetoothd"

# FZF
fzf_git_log() {
    local commits=$(
      git l --color=always "$@" |
        fzf --ansi --no-sort --height 100% \
            --preview "git show --color=always {2}"
      )
    if [ -n "$commits" ]; then
        local hashes=$(printf "$commits" | cut -d' ' -f2 | tr '\n' ' ')
        git show $hashes
    fi
}

fzf_git_add() {
    local files=$(git ls-files --modified | fzf --ansi)
    if [ -n "$files" ]; then
        git add --verbose $files
    fi
}

# Git
gtag() {
  if [ -z $1 ]; then
    echo "No tag provided"
    return
  fi

  git tag -a $1 -m "Release $1"

  if [[ "$2" =~ ^[Yy]$ ]] then
    echo "Pusing to origin --tags"
    git push origin --tags
  else
    echo "Added tag, but didn't push it to origin"
  fi
}

# Brew
BREW_REQUIREMENTS_DIR=$HOME/git/internal/dotfiles/requirements

brew_update() {
  (cd $BREW_REQUIREMENTS_DIR && brew bundle install) # temporary move to './requirements' and run 'brew bundle'
}

brew_cleanup() {
  (cd $BREW_REQUIREMENTS_DIR && brew bundle cleanup $1)
}

alias glo='fzf_git_log'
alias gaa='fzf_git_add'
alias gl='git l'
alias ga='git add'
alias gs='git s'
alias gd='git d'
alias gco='git checkout'
alias gc='git commit'
alias gcm='git commit -m'
alias gca='git commit --amend'
alias gf='git fetch'
alias gpull='git pull'
alias gpush='git push'

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# GCP
source "$(brew --prefix)/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/completion.zsh.inc"
source "$(brew --prefix)/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/path.zsh.inc"

# NVM
export NVM_DIR="$HOME/.nvm"
  [ -s "$(brew --prefix)/opt/nvm/nvm.sh" ] && \. "$(brew --prefix)/opt/nvm/nvm.sh" # This loads nvm
  [ -s "$(brew --prefix)/opt/nvm/etc/bash_completion.d/nvm" ] && \. "$(brew --prefix)/opt/nvm/etc/bash_completion.d/nvm" # This loads nvm bash_completion

# added by travis gem
[ -f $HOME/.travis/travis.sh ] && source $HOME/.travis/travis.sh

# Created by `pipx` on 2023-11-01 07:40:00
export PATH="$PATH:/Users/hakloev/.local/bin"
